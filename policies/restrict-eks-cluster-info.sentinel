import "tfplan/v2" as tfplan

tfplan.mock = import "mock-tfplan.sentinel"

allowed_kubernetes_versions = ["1.31"]

check_k8s_version = rule {
    all tfplan.resources.aws_eks_cluster as cluster {
        cluster.applied.version in allowed_kubernetes_versions
    }
}

main = rule {
    check_k8s_version
}
