import "tfplan/v2" as tfplan

tfplan.mock = import "mock-tfplan.sentinel"

check_vpc_endpoints = rule {
    all tfplan.resources.aws_eks_cluster as cluster {
        cluster.applied.vpc_config.endpoint_private_access == true and
        cluster.applied.vpc_config.endpoint_public_access == false
    }
}

main = rule {
    check_vpc_endpoints
}
